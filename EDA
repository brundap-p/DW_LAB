import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris

# Load the Iris dataset
iris = load_iris(as_frame=True)
df = iris.frame
print(df)

df.info()
df.head()
df.tail()
df.columns.str.strip
df.isna().sum()
df.describe

# Feature Engineering
# Create new features by calculating the ratio and area of sepal and petal
df['sepal_area'] = df['sepal length (cm)'] * df['sepal width (cm)']
df['petal_area'] = df['petal length (cm)'] * df['petal width (cm)']
df['sepal_ratio'] = df['sepal length (cm)'] / df['sepal width (cm)']
df['petal_ratio'] = df['petal length (cm)'] / df['petal width (cm)']

# Print the DataFrame with the new features
print(df.head())

#univariate
# Create a histogram for a numerical feature
plt.figure(figsize=(10, 6))
sns.histplot(df['sepal length (cm)'], kde=True)
plt.title('Distribution of Sepal Length')
plt.xlabel('Sepal Length (cm)')
plt.ylabel('Frequency')
plt.show()

# Create a line chart for a numerical feature
plt.figure(figsize=(12, 6))
sns.lineplot(data=df, y='sepal length (cm)', x=df.index)
plt.title('Sepal Length over Sample Index')
plt.xlabel('Sample Index')
plt.ylabel('Sepal Length (cm)')
plt.show()

#bivariate
# Bivariate Analysis - Plot 1: Bar Plot
# Map the target column to species names for better readability
species_map = {0: 'setosa', 1: 'versicolor', 2: 'virginica'}
df['species_name'] = df['target'].map(species_map)

plt.figure(figsize=(10, 8))
sns.barplot(x='species_name', y='sepal length (cm)', data=df, errorbar=None, hue='species_name', palette='viridis')
plt.title('Average Sepal Length by Species')
plt.xlabel('Species')
plt.ylabel('Average Sepal Length (cm)')
plt.show()

# Bivariate Analysis - Plot 1: Box Plot
plt.figure(figsize=(10, 8))
sns.boxplot(x='species_name', y='sepal length (cm)', data=df, hue='species_name', palette='viridis')
plt.title('Sepal Length Distribution by Species (Box Plot)')
plt.xlabel('Species')
plt.ylabel('Sepal Length (cm)')
plt.show()

#Multivariate
# Multivariate Analysis - Plot 2: Correlation Heatmap
numerical_cols = ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
correlation_matrix = df[numerical_cols].corr()

plt.figure(figsize=(12, 10))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title('Correlation Heatmap of Iris Features')
plt.show()

# Select only the specified columns for the pair plot
selected_cols = ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)', 'species_name']
df_selected = df[selected_cols]

# Create the pair plot with only the selected columns
sns.pairplot(df_selected, hue='species_name')
plt.suptitle('Pair Plot of Iris Dataset (Original Features Only)', y=1.02)
plt.show()
